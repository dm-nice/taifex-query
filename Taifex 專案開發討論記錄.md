# Taifex 專案開發討論記錄

> **用途**: 整合網頁版 Claude 和 VS Code Cline 的討論內容  
> **更新**: 隨時記錄重要討論和決定  
> **建立日期**: 2025-12-04

---

## 📖 使用說明

### 從網頁版 Claude 更新
1. 與網頁版 Claude 討論完後
2. 請 Claude 整理討論重點（格式化）
3. 複製整理好的內容
4. 貼到本檔案對應的日期區塊
5. 儲存（Ctrl+S）

### 讓 VS Code Cline 讀取
```
在 Cline 對話框輸入：
「讀取 _discussion_log.md 的最新討論內容」
```

### 讓 Cline 自動更新
```
在 Cline 完成任務後輸入：
「把剛才的工作記錄追加到 _discussion_log.md」
```

---

## 🗂️ 討論記錄

### 2025-12-04 (三) - 專案規劃與工具設定

#### 📋 背景說明
建立 Taifex 期貨資料自動抓取系統，統一管理多個資料來源的 fetcher 模組。

#### ✅ 已完成事項
- [x] 訂閱 Claude Pro ($20/月)
- [x] 了解 Anthropic API Key 方案與費用
- [x] 在 VS Code 找到 Cline/Claude 擴充套件
- [x] 建立專案目錄結構 (`C:\Taifex\`)
- [x] 完成 `run.py`（主控程式，混合模式）
- [x] 完成 `f01_fetcher.py`（台指期外資未平倉）
- [x] 撰寫「共同開發規範書 v1.0」
- [x] 撰寫「f01_fetcher 開發規範書」（精簡版）
- [x] 撰寫「run.py 開發規格書」
- [x] 統一採用混合模式設計

#### 🎯 當前任務
- [ ] 安裝 Cline 擴充套件到 VS Code
- [ ] 申請並設定 Anthropic API Key
- [ ] 測試 Cline 基本功能
- [ ] 用 Cline 檢查現有程式碼

#### 📝 重要決定

**混合模式設計原則**:
- 程式內部（JSON key）: 使用英文
- 使用者介面（訊息）: 使用中文
- 理由: 符合國際標準 + 使用者友善

**文件架構**:
```
C:\Taifex\dev\
├── 共同開發規範書_V1.md      ← 所有模組通用
├── run.py 開發規格書.md       ← 系統維護者參考
├── _discussion_log.md         ← 本檔案（討論橋樑）
├── f01_package\
│   └── f01_fetcher_開發規範書.md
└── f02_package\
    └── ...
```

**工具使用策略**:
- Claude Pro (網頁版): 規劃、討論、學習、檢視
- Cline + API Key: 實作、修改檔案、執行指令
- 兩者配合使用，效率最高

#### 💡 技術重點

**run.py 核心機制**:
- 動態載入模組（`importlib`）
- 統一執行介面（`fetch(date: str)`）
- 結果驗證與正規化
- 集中輸出到 `data/` 目錄
- 中文使用者介面

**fetcher 模組規範**:
- 必須提供 `fetch(date: str) -> dict`
- 回傳格式: `{module, date, status, summary, data, source}`
- 狀態碼: `success` / `failed` / `error`
- 完整錯誤處理
- 支援獨立測試

#### 🔄 下一步計畫

**短期（本週）**:
1. 安裝並熟悉 Cline
2. 用 Cline 檢查現有程式碼是否符合規範
3. 規劃 f02 模組（待討論資料來源）

**中期（下週）**:
1. 開發 f02 模組
2. 開發 f03 模組
3. 建立模組開發範本（template）

**長期**:
1. 建立完整的測試流程
2. 自動化每日執行
3. 資料視覺化（可選）

#### 📌 待解決問題
- [ ] 確認 f02 模組的資料來源
- [ ] 決定是否需要資料庫儲存
- [ ] 規劃錯誤通知機制

---

### 2025-12-04 (三) - Cline 安裝與設定

#### 🎯 任務
安裝 Cline 並完成 API Key 設定

#### 📝 步驟記錄
（待完成後由 Cline 自動填寫，或手動更新）

---

<!-- ========================================== -->
<!-- 以下空白區域供後續新增討論記錄 -->
<!-- 每次新增請依照上方格式 -->
<!-- ========================================== -->

## 📅 未來討論記錄

### YYYY-MM-DD - 主題名稱

#### 背景
[簡述]

#### 討論重點
1. [重點 1]
2. [重點 2]

#### 決定事項
- [決定 1]
- [決定 2]

#### 待處理
- [ ] [任務 1]
- [ ] [任務 2]

#### 給 Cline 的指示
```
[具體任務說明]
```

---

## 📊 專案整體狀態

### 模組開發進度

| 模組 | 狀態 | 完成度 | 備註 |
|------|------|--------|------|
| f01_fetcher | ✅ 完成 | 100% | 台指期外資未平倉 |
| f02_fetcher | 📋 規劃中 | 0% | 待確認資料來源 |
| f03_fetcher | ⏳ 待開發 | 0% | - |

### 文件完成度

| 文件 | 狀態 | 版本 | 備註 |
|------|------|------|------|
| 共同開發規範書 | ✅ v1.0 | 2025-12-04 | 已完成 |
| run.py 開發規格書 | ✅ v1.0 | 2025-12-04 | 已完成 |
| f01 開發規範書 | ✅ v2.0 | 2025-12-04 | 精簡版 |
| f02 開發規範書 | ⏳ 待建立 | - | - |

---

## 🔖 快速參考

### 常用指令

```bash
# 測試單一模組（獨立執行）
python f01_fetcher.py 2025-12-01

# 驗收模式（測試 dev/ 模組）
python run.py 2025-12-01 dev

# 正式模式（執行 modules/ 模組）
python run.py 2025-12-01

# 執行特定模組
python run.py 2025-12-01 dev --module f01_fetcher_dev

# 顯示說明
python run.py --help
```

### 重要路徑

```
專案根目錄: C:\Taifex\
輸出目錄:   C:\Taifex\data\
開發目錄:   C:\Taifex\dev\
正式目錄:   C:\Taifex\modules\
規範書:     C:\Taifex\dev\共同開發規範書_V1.md
```

### 關鍵概念速查

**混合模式**:
- JSON key: 英文（`module`, `status`, `data`）
- 訊息內容: 中文（`summary`, `error`）

**狀態碼**:
- `success`: 成功取得資料
- `failed`: 業務邏輯失敗（無資料、找不到欄位）
- `error`: 技術性錯誤（網路錯誤、程式異常）

**標準回傳格式**:
```json
{
  "module": "f01",
  "date": "2025-12-01",
  "status": "success",
  "summary": "台指期外資淨額 -29,032 口",
  "data": {...},
  "source": "TAIFEX"
}
```

---

## 💭 備註與心得

### 經驗分享

**關於混合模式**:
- 程式內部用英文 key 的好處: 避免編碼問題、符合國際標準
- 顯示用中文的好處: 使用者友善、易於理解
- 兩者結合是最佳方案

**關於 Claude Pro vs API Key**:
- Pro: 適合規劃、討論、學習
- API: 適合實作、批次處理、自動化
- 建議兩者搭配使用

**關於文件撰寫**:
- 共同規範書: 避免每個模組重複寫相同內容
- 個別規範書: 只寫該模組特有的部分
- 定期檢視並更新規範書

---

**最後更新**: 2025-12-04 by 網頁版 Claude  
**下次更新**: 安裝 Cline 後由 Cline 自動更新